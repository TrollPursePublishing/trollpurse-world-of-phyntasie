"use strict";angular.module("app.controllers",["app.services"]).controller("CommandCtrl",["$scope","$location","$window","UserService","CommandService","MessageService",function(n,t,i,r,u,f){n.checkRerouteToUserpage=function(){return r.isLoggedIn?(f.startupServices().then(function(){f.chatConnected&&n.$parent.$emit("chatready")},function(n){console.log("error",n)}),!0):(t.path("/"),!1)};n.user=r.user;n.messages=[];n.currentDescription={};n.navigation={};n.$parent.$on("chat",function(t,i){console.log("chat",i.name+":"+i.msg);n.$apply(function(){n.messages.push(i.name+" said, "+i.msg)})});n.$parent.$on("chatready",function(){console.log("chatready","initialized");f.joinLocation(r.user.navigation.currentLocation.Id)});n.submit=function(t){t.indexOf('"')===0&&t.lastIndexOf('"')===t.length-1?f.send(n.user.FullName,t,n.user.navigation.currentLocation.Id):(f.leaveLocation(n.user.navigation.currentLocation.Id),u.submit(t,n.user.Id).then(function(t){for(var i=angular.fromJson(t.data),u=0;u<i.messages.length;u++)n.messages.push(i.messages[u]);n.user=i.player;r.user=n.user;f.joinLocation(n.user.navigation.currentLocation.Id)},function(t){console.error("error",t);f.joinLocation(n.user.navigation.currentLocation.Id)}))};n.detailedView=function(t){delete t.Id;n.currentDescription=t}}]).controller("HomeCtrl",["$scope","$location","$window","RanksService","NotificationService",function(n,t,i,r,u){n.$root.title="AdventureQuestGame";n.items={};n.events={};n.acheivements={};n.getData=function(){u.getEvents().then(function(t){n.events=angular.fromJson(t.data).events},function(n){console.error("error",n)});u.getAllPlayerAchievements().then(function(t){n.acheivements=angular.fromJson(t.data).pairs},function(n){console.error("error",n)});r.get().then(function(t){n.items=angular.fromJson(t.data).pairs},function(n){console.error("error",n)})};n.$on("$viewContentLoaded",function(){n.getData()})}]).controller("SignUpCtrl",["$scope","$location","$window","UserService",function(n,t,i,r){n.$root.title="AdventureQuestGame | Join Now!";n.error={};n.hasError=!1;n.registered=!1;n.notification="";n.signup=function(t,i,u,f,e){return r.register(t,i,u,f,e).then(function(t){console.log(t);n.error={};n.hasError=!1;n.registered=!0;n.notification=t.data.Errors[0]},function(t){n.hasError=!0;var i=angular.fromJson(t);console.log(i);n.error=angular.fromJson(i.ModelState)}),n.success};n.checkRerouteToUserpage=function(){return r.isLoggedIn?(t.path("/userwelcome"),!0):!1}}]).controller("RanksCtrl",["$scope","$location","$window","RanksService","UserService","$filter",function(n,t,i,r,u,f){n.$root.title="AdventureQuestGame | Ranks";n.items={};n.rankuser={};n.isLoggedIn=u.isLoggedIn;n.rank="";n.getData=function(){r.getAll().then(function(t){if(n.items=f("orderBy")(angular.fromJson(t.data).pairs,"-score"),n.isLoggedIn)for(var i=0;i<n.items.length;++i)if(n.items[i].name===u.user.FullName){n.rank=i+1;break}});u.isLoggedIn&&r.getById(u.user.Id).then(function(t){n.rankuser=angular.fromJson(t.data)})};n.$on("$viewContentLoaded",function(){n.getData()})}]).controller("AboutCtrl",["$scope","$location","$window",function(n){n.$root.title="AdventureQuestGame | About"}]).controller("LoginCtrl",["$scope","$location","$window","UserService",function(n,t,i,r){n.$root.title="AdventureQuestGame | Sign In";n.user={};n.isLoggedIn=!1;n.authError="";n.bAuthError=!1;n.login=function(t,i){r.login(t,i).then(function(t){var i=angular.fromJson(t.data),u=i.message,f=!i.isError;n.bAuthError=i.isError;f?r.getPlayerData(u).then(function(t){n.user=angular.fromJson(t.data);r.user=n.user;r.isLoggedIn=!0},function(){n.user={};r.user=n.user;r.isLoggedIn=!1}):n.authError=u},function(){n.user={};r.user=n.user;r.isLoggedIn=!1})};n.checkRerouteToUserpage=function(){return r.isLoggedIn?(t.path("/userwelcome"),!0):!1};n.$watch(n.user,function(){n.user.Id!==undefined&&r.isLoggedIn?t.path("/userwelcome"):t.path("/login")})}]).controller("UserCtrl",["$scope","$location","$window","UserService","NotificationService",function(n,t,i,r,u){n.$root.title="AdventureQuestGame | "+r.userName;n.username="";n.isLoggedIn=!1;n.userImageUrl="";n.user={};n.acheivements={};n.logout=function(){r.logout(r.user.Id).then(function(){r.isLoggedIn=!1;r.user={};n.isLoggedIn=!1;n.acheivements={};n.username="";t.path("/")})};n.adventure=function(){t.path("/adventure")};n.checkRerouteToUserpage=function(){return r.isLoggedIn?(n.username=r.user.FullName,n.isLoggedIn=r.isLoggedIn,n.userImageUrl=r.getUserImage(r.user.Id),!0):(t.path("/"),!1)};n.getData=function(){u.getPlayerAcheivements(r.user.Id).then(function(t){n.acheivements=angular.fromJson(t.data)},function(n){console.error("error",n)});n.user=r.user};n.$on("$viewContentLoaded",function(){n.getData()})}]).controller("Error404Ctrl",["$scope","$location","$window",function(n){n.$root.title="Error 404: Page Not Found"}]);
/*
//# sourceMappingURL=controllers.min.js.map
*/