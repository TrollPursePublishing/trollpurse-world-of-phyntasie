"use strict";angular.module("app.controllers",["app.services"]).controller("CommandCtrl",["$scope","$location","$window","UserService","CommandService","MessageService","$filter",function(n,t,i,r,u,f,e){function o(){r.isLoggedIn()?r.getPlayerData().then(function(t){n.user=angular.fromJson(t.data);n.navigation=n.user.navigation;f.startupServices().then(function(){f.chatConnected&&n.$parent.$emit("chatready")},function(n){console.log("error",n)})},function(){t.path("/login")}):t.path("/login")}n.user;n.currentDescription={};n.navigation={};n.chat=[];n.chatlist={};n.showmenu=!0;o();n.messages=[];n.$parent.$on("chat",function(t,i){console.log("chat",i.name+":"+i.msg);n.$apply(function(){n.chat.push(i.name+" said, "+i.msg)})});n.$parent.$on("playerjoin",function(t,i){n.$apply(function(){i.name!=n.user.FullName&&(n.chat.push(i.name+" has entered."),n.chatlist[i.name]=0)})});n.$parent.$on("playerleave",function(t,i){n.$apply(function(){i.name!=n.user.FullName&&(n.chat.push(i.name+" has left."),delete n.chatlist[i.name])})});n.$parent.$on("chatready",function(){console.log("chatready","initialized");f.joinLocation(n.user.navigation.currentLocation.Id,n.user.FullName)});n.submit=function(i){i.indexOf('"')===0&&i.lastIndexOf('"')===i.length-1?f.send(n.user.FullName,i,n.user.navigation.currentLocation.Id):(f.leaveLocation(n.user.navigation.currentLocation.Id,n.user.FullName),u.submit(i,n.user.Id).then(function(i){var r=angular.fromJson(i.data),u;for(t.path().indexOf("play")>-1&&r.messages!=undefined&&r.messages.reverse(),u=0;u<r.messages.length;u++)n.messages.push(r.messages[u]);n.user=r.player;f.joinLocation(n.user.navigation.currentLocation.Id,n.user.FullName)},function(t){console.error("error",t);f.joinLocation(n.user.navigation.currentLocation.Id,n.user.FullName)}))};n.detailedView=function(t){delete t.Id;n.currentDescription=t;angular.forEach(t,function(t,i){i.indexOf("$")<0&&n.messages.push(e("property")(i)+":   "+t)})};n.propertyList=function(n){var t=[];return delete n.Id,angular.forEach(n,function(n,i){i.indexOf("$")<0&&t.push(e("property")(i)+":   "+n)}),t};n.do=function(t,i){n.submit(t+" "+i)};n.reverse=function(n){return angular.copy(n).reverse()};n.togglemenu=function(){n.showmenu=!n.showmenu};n.chat=function(t){n.submit('"'+t+'"')};n.temphcodeareas=["Haunted Forest","Vast Desert","Buttleberry","Reedton","The Barren Wastes"]}]).controller("ResetCtrl",["$scope","$routeParams","$window","AccountService",function(n,t,i,r){function u(){r.resetConfirm(t.hash,t.securityStamp).then(function(t){n.enterResult=angular.fromJson(t.data)},function(){n.enterResult={msg:"Reset not successful, please contact support. I'm Sorry",success:!1}})}n.$root.title="External Portal";n.result={};n.enterResult={};n.showClick=!1;n.errored=!1;u();n.resetPassword=function(t,i){n.showClick=!0;n.errored=!1;r.resetPassword(n.enterResult.additionalData,t,i).then(function(t){n.showClick=!1;n.result=t.data;n.errored=!n.result.success},function(){n.showClick=!1;n.errored=!0;n.result={msg:"Reset not successful. Please contact support.",success:!1,additionalData:n.enterResult.additionalData}})}}]).controller("HomeCtrl",["$scope","$location","$window","RanksService","NotificationService","gamename",function(n,t,i,r,u,f){function e(){u.getEvents().then(function(t){n.events=angular.fromJson(t.data).events},function(n){console.error("error",n)});u.getAllPlayerAchievements().then(function(t){n.acheivements=angular.fromJson(t.data).pairs},function(n){console.error("error",n)});r.get().then(function(t){n.items=angular.fromJson(t.data).pairs},function(n){console.error("error",n)})}n.$root.title=f;n.items={};n.events={};n.acheivements={};e()}]).controller("SignUpCtrl",["$scope","$location","$window","UserService","gamename",function(){}]).controller("RanksCtrl",["$scope","$location","$window","RanksService","UserService","$filter","gamename",function(n,t,i,r,u,f,e){function o(){n.page(1)}n.$root.title=e+" | Ranks";n.items={};n.rankuser={};n.rank="";n.user={};n.isLoggedIn=u.isLoggedIn;n.count=0;n.pages=1;n.pageArray=[];n.currentPage=0;n.resultsPerPage=50;n.page=function(t){t!=n.currentPage&&(n.currentPage=t,n.pages=[],r.Count().then(function(i){if(i=angular.fromJson(i).data,n.count=i,n.pages=i/n.resultsPerPage,n.pages>0)for(var e=0;e<n.pages;++e)n.pageArray.push(e+1);r.getAll(n.resultsPerPage*(t-1),n.resultsPerPage).then(function(t){n.items=f("orderBy")(angular.fromJson(t.data).pairs,"-score");u.isLoggedIn()&&u.getPlayerData().then(function(t){n.user=angular.fromJson(t.data);r.getById(n.user.Id).then(function(t){n.rankuser=angular.fromJson(t.data)});for(var i=0;i<n.items.length;++i)if(n.items[i].name===n.user.FullName){n.rank=i+1;break}})})}))};o()}]).controller("AboutCtrl",["$scope","$location","$window","gamename",function(n,t,i,r){n.$root.title=r+" | About"}]).controller("LoginCtrl",["$scope","$location","$window","UserService","gamename",function(n,t,i,r,u){function f(){r.isLoggedIn()&&t.path("/userwelcome")}n.$root.title=u+" | Login";n.authError="";n.result={};n.bAuthError=!1;n.bResetError=!1;n.pleasewait="";f();n.reset=function(t){n.pleasewait="Sending reset. Please wait.";n.hasClicked=!0;r.reset(t).then(function(t){n.bResetError=!1;n.result=angular.fromJson(t.data);n.hasClicked=!1},function(t){n.bResetError=!0;n.result={msg:angular.isDefined(t.Message)?t.Message:"Sorry, an error occured. Please contact support",success:!1};n.hasClicked=!1})};n.login=function(i,u){n.pleasewait="Logging in. Please wait.";n.hasClicked=!0;r.login(i,u).then(function(i){n.bAuthError=!1;n.authError="";var u=angular.fromJson(i.data);localStorage.setItem("aqg_token",angular.toJson(i.data));r.onLoginSuccess();n.hasClicked=!1;t.path("/userwelcome")},function(t){n.authError=t.data.error==="invalid_grant"?"Incorrect username or password":t.data.error;n.bAuthError=!0;n.hasClicked=!1})};n.error={};n.hasError=!1;n.registered=!1;n.notification="";n.hasClicked=!1;n.emailOptout=!1;n.signup=function(t,i,u,f,e,o){return n.pleasewait="Registering. Please wait.",n.hasClicked=!0,n.registered=!1,r.register(t,i,u,f,e,o).then(function(t){n.error={};n.hasError=!1;n.registered=!0;n.notification=o?t.data.msg:t.data.Errors[0];n.hasClicked=!1;n.userName="";n.spassword="";n.confirmpassword="";n.email="";n.gender="";n.emailOptout=!1},function(t){n.hasError=!0;var i=angular.fromJson(t);console.log(i);n.error=angular.fromJson(i.ModelState);n.hasClicked=!1}),n.success}}]).controller("UserCtrl",["$scope","$location","$window","UserService","NotificationService","AccountService","gamename",function(n,t,i,r,u,f,e){function o(){r.isLoggedIn()||t.path("/login");r.getPlayerData().then(function(t){n.user=angular.fromJson(t.data);u.getPlayerAcheivements(n.user.Id).then(function(t){n.acheivements=angular.fromJson(t.data)},function(n){console.error("error",n)});f.getSendMail(n.user.Id).then(function(){n.currentlySendMail=!0},function(n){console.error("error",n)})},function(){t.path("/login")})}n.$root.title=e;n.user={};n.acheivements={};n.registerText="Register To Get Email";n.registerSuccess=!1;n.currentlySendMail=!1;o();n.registerToGetEmail=function(){n.currentlySendMail||f.registerForUpdates(n.user.Id).then(function(t){n.registerText=angular.fromJson(t.data).msg;n.registerSuccess=!0;n.currentlySendMail=!0},function(){n.registerText="Unfortunately, we could not register you to get updates :(";n.registerSuccess=!1})};n.logout=function(){r.logout();r.clearToken();t.path("/")};n.adventure=function(){t.path("/adventure")};n.adventurenew=function(){t.path("/play")}}]).controller("AccountCtrl",["$scope","$routeParams","$window","AccountService",function(n,t,i,r){function u(){r.doNotDisturb(t.hash).then(function(t){n.result=angular.fromJson(t.data)},function(){n.result={msg:"Action not successful.",success:!1}})}n.$root.title="External Portal";n.result={};u()}]).controller("RegisterCtrl",["$scope","$routeParams","$window","AccountService",function(n,t,i,r){function u(){r.confirmEmail(t.hash,t.confirmationCode).then(function(t){n.result=angular.fromJson(t.data)},function(){n.result={msg:"Registration not successful, please contact support.",success:!1}})}n.$root.title="External Portal";n.result={};u()}]).controller("Error404Ctrl",["$scope","$location","$window",function(n){n.$root.title="Page Not Found"}]);
//# sourceMappingURL=controllers.min.js.map
